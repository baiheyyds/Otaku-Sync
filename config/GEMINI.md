# `config` 模块说明

`config` 目录是项目的配置中心，它将所有与环境、API密钥和数据库结构相关的硬编码值分离出来，使得配置的修改和管理变得集中和方便。

## 1. 设计理念

- **配置与代码分离**: 敏感信息（如API Token）和易变信息（如Notion数据库字段名）不应硬编码在业务逻辑中。将它们集中到 `config` 模块，可以提高代码的安全性和可维护性。
- **环境变量优先**: 所有的私密信息（API密钥、数据库ID）都通过 `.env` 文件进行管理，并由 `config_token.py` 模块加载到环境变量中。`.env` 文件本身被 `.gitignore` 忽略，确保了敏感数据不会被意外提交到版本库。
- **启动时校验**: `config_token.py` 在程序启动时会立即检查所有关键的配置项是否已加载，如果发现缺失，会立刻报错并终止程序，以防止在运行时因配置错误导致更复杂的问题（Fail-fast原则）。

## 2. 核心文件概览

- **`config_token.py`**: 
    - **作用**: **安全地加载和提供配置信息**。这是项目中所有需要访问API密钥或数据库ID的模块的唯一入口。
    - **工作流程**: 
        1.  使用 `python-dotenv` 库查找并加载项目根目录下的 `.env` 文件。
        2.  从加载的环境变量中读取 `NOTION_TOKEN`, `GAME_DB_ID`, `BRAND_DB_ID` 等关键配置。
        3.  执行一次严格的启动时检查，确保所有必需的变量都已成功加载，否则程序将立即退出并给出明确的错误提示。
    - **如何使用**: 项目中其他任何需要配置信息的地方，都应该从这个文件导入（例如 `from config.config_token import NOTION_TOKEN`）。

- **`config_fields.py`**: 
    - **作用**: **定义 Notion 数据库字段名与程序内部键名的映射**。它是一个巨大的字典 `FIELDS`，充当了程序代码和 Notion 数据库结构之间的“翻译层”。
    - **示例**: `"game_name": "游戏名称"` 表示程序内部使用 `game_name` 这个键来代表 Notion 中名为“游戏名称”的字段。
    - **重要性**: 这是保证程序能正确读写 Notion 数据库的**关键**。如果用户修改了 Notion 数据库中的某个字段名（例如，将“游戏名称”改为“Title”），那么**必须**同步修改此文件中的对应值（`"game_name": "Title"`），否则程序将无法找到该字段。

## 3. 如何修改配置

- **修改 API Token 或数据库 ID**: 
    1.  打开项目根目录下的 `.env` 文件（如果不存在，请从 `.env.example` 复制）。
    2.  直接修改 `NOTION_TOKEN="..."` 或 `GAME_DB_ID="..."` 等行的值。
    3.  重新启动程序即可。

- **修改 Notion 数据库的字段名**: 
    1.  在 Notion 中修改你的数据库字段名。
    2.  打开 `config/config_fields.py` 文件。
    3.  找到与你修改的字段对应的键值对，并更新其值（字符串部分）。
    4.  重新启动程序。

- **为 Notion 数据库添加新字段并让程序使用它**: 
    1.  在 Notion 中添加新字段。
    2.  在 `config/config_fields.py` 的 `FIELDS` 字典中，添加一个新的键值对，例如 `"new_feature_field": "新功能字段名"`。
    3.  在 `core` 或 `clients` 模块的相关逻辑中，使用 `FIELDS["new_feature_field"]` 来引用这个新字段。